/*
 * Golabi-Admin - v1.4.0
 * 2015-11-02
 * Responsive Bootstrap Template
 *
 * All right reserved. Copyright 2015 
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(window.jQuery)}(function(a){var b=a.summernote.core.range,c=a.summernote.core.list,d={UP:38,DOWN:40,ENTER:13},e=[38,40,13];a.summernote.addPlugin({name:"hint",scrollTo:function(a){var b=a.parent();b[0].scrollTop=a[0].offsetTop-b.innerHeight()/2},moveDown:function(a){var b=a.find(".active").index();this.activate(a,-1===b?0:(b+1)%a.children().length)},moveUp:function(a){var b=a.find(".active").index();this.activate(a,-1===b?0:(b-1)%a.children().length)},activate:function(a,b){b=b||0,0>b&&(b=a.children().length-1),a.children().removeClass("active");var c=a.children().eq(b);c.addClass("active"),this.scrollTo(c)},replace:function(a){var c=a.data("wordRange"),d=a.find(".active"),e=this.content(d.html(),d.data("keyword"));"string"==typeof e&&(e=document.createTextNode(e)),a.removeData("wordRange"),c.insertNode(e),b.createFromNode(e).collapse().select()},searchKeyword:function(b){var c=b.charAt(0);if(":"===c&&b.length>1){var d=b.toLowerCase().replace(":","");return{type:"emoji",list:a.grep(this.emojiKeys,function(a){return 0===a.indexOf(d)})}}return null},createItems:function(b){for(var c=[],d=b.list,e=0,f=d.length;f>e;e++){var g=a('<a class="list-group-item"></a>');g.append(this.createItem(d[e])),g.data("keyword",d[e]),c.push(g)}return c.length&&c[0].addClass("active"),c},createItem:function(a){var b=this.emojiInfo[a];return'<img src="'+b+'" width="20" /> :'+a+":"},content:function(b,c){var d=this.emojiInfo[c];if(d){var e=a("<img />").attr("src",d).css({width:20});return e[0]}return b},loadEmojis:function(){var b=this;return a.getJSON("https://api.github.com/emojis").then(function(a){b.emojiKeys=Object.keys(a),b.emojiInfo=a})},init:function(b){var f=this,g=b.holder(),h=a('<div class="list-group" />').css({position:"absolute","max-height":300,"overflow-y":"scroll",display:"none"});h.on("click",".list-group-item",function(){f.replace(h),h.hide(),g.summernote("focus")}),a(document).on("click",function(){h.hide()}),g.on("summernote.keydown",function(a,b){"block"===h.css("display")&&(b.keyCode===d.DOWN?(b.preventDefault(),f.moveDown(h)):b.keyCode===d.UP?(b.preventDefault(),f.moveUp(h)):b.keyCode===d.ENTER&&(b.preventDefault(),f.replace(h),h.hide(),g.summernote("focus")))}),g.on("summernote.keyup",function(d,g){if(-1===e.indexOf(g.keyCode)){var i=a(this).summernote("createRange").getWordRange(),j=f.searchKeyword(i.toString());if(!j||!j.list.length)return void h.hide();b.popover().append(h);var k=c.last(i.getClientRects());h.html(f.createItems(j)).css({left:k.left,top:k.top+k.height}).data("wordRange",i).show()}}),this.loadEmojis()},events:{ENTER:function(){return!1}}})});